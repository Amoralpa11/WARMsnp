var log10_p_values = [0.5807014745,0.5732571767,0.0769191056,0.6453018206,0.2487370669,0.2311968686,0.2639956554,0.2309865849,0.2932316240,0.0964307621,0.2593990666,0.0001906971,0.2292407459,0.7951846175,0.4951584803,0.0652609355,0.3993584483,0.1514685106,0.8828311569,0.2332889010,0.0921872099,0.9034438205,0.8155382667,0.6319921948,1.1416318613,0.8086141066,0.2906616770,0.0886674298,0.6637036076,0.6693119366,0.7847331857,0.1333439331,0.6577797081,0.2523475711,0.0631235921,0.0138304719,0.4295765075,0.2359085670,0.8549854947,0.0481648337,0.3232892018,0.2113788265,0.3697244090,0.4242181786,0.4634945850,0.7502458568,0.3715974793,0.3946401047,1.1249369994,0.4916890320,0.8983309274,0.5098535076,0.3705479930,0.7542547015,0.3771794250,0.6987516091,0.4936488244,1.1289790391,1.0025406568,0.4080094405,0.2604486193,1.0129865608,0.5387448003,0.4745928703,0.8753112718,0.5729371934,0.5280007895,0.6770673940,0.1072654517,0.0552675323,0.6406979463,0.1286414043,0.5307619505,0.5322170281,0.1437081608,0.1385201333,0.6249204704,0.5361283532,0.1188243228,0.6216348087,0.3383803771,0.0914694630,0.6185421335,0.3719889172,0.8217688961,0.8276472688,0.8023567162,0.5293946054,0.4928049742,0.0472866280,0.3271999846,0.6179361066,0.7569274573,0.0014789864,0.0380642754,0.0297725479,0.2097891721,0.4975956879,0.4985488166,0.4949086554,0.9263659513,0.0827321308,0.0922092810,0.4967230139,0.0313141946,0.4968279803,0.3798938363,0.8339163942,0.5210023097,0.0547303890,0.1663466976,0.4515496498,0.6667172041,0.4984209915,0.5352909762,0.0491072535,0.3038146539,0.4612765006,0.1808786543,0.4434943934,0.0971073904,0.2256369989,0.1480801315,0.1413016261,0.7451593500,0.0014070458,0.4885730885,0.6251058142,0.5603510970,0.0696853083,0.1227147728,0.0550959706,0.2267266765,0.2142813963,0.2355587374,0.3553838883,0.3886943039,0.4256354378,0.3520402123,0.0927370665,0.2177880307,0.0423015063,0.2113178527,0.7840310930,0.1299475355,0.8082779854,0.0295724102,0.8872857684,0.2925649872,0.1533600391,0.1405874570,0.2298068489,0.0449289719,1.0094245236,0.0009509292,0.2238045769,0.2440760033,0.5527470547,0.3027450189,0.2883886271,0.3696425128,0.2779392636,0.2661620414,0.6894617447,0.1669523854,0.2003728418,0.5207586362,0.2822843227,0.3416710641,0.5354043510,0.1835976762,0.0016675005,0.5252026366,0.1632436409,0.5144790197,0.1597367846,0.3758081767,0.0738353726,0.0876059608,0.9404664953,0.1513451749,0.4617600321,0.1417362775,0.0933559432,0.1420068533,0.0416776976,0.8497490476,0.5630925327,0.4051766841,0.1930509882,0.7854605295,0.9673179931,0.1185788207,0.8667469898,1.2742974018,0.0158147664,0.1817081752,1.1466930728,1.2503973935,0.1877765166,0.3538932249,0.1332935770,0.0361327324,0.1338825712,0.1296836648,0.1837940417,0.1075532605,0.1241657438,0.0256865713,0.0226909552,0.0595313299,0.1272389344,0.0163285720,1.7633922092,0.1171658175,0.3161768812,0.1712665245,0.4124314665,0.2996942512,0.3474047193,0.2813289444,0.9468639106,0.3252629218,0.0230957895,0.2973442748,0.3036764686,0.2235725514,0.1930836394,0.6305143699,0.3089706086,1.2917559133];
var locations = [1186502,1186665,1186821,1186998,1187448,1187641,1187867,1187993,1188225,1188306,1188944,1189319,1189552,1189663,1190061,1190206,1190207,1190523,1190913,1190990,1191870,1192515,1192786,1192796,1192963,1193432,1193476,1193586,1193713,1193723,1193852,1194470,1194545,1194638,1194804,1195593,1195657,1195690,1195820,1196374,1197271,1197398,1197541,1197867,1198578,1198618,1199207,1199573,1200192,1200202,1201640,1202437,1202471,1203387,1203464,1203938,1204354,1204479,1205155,1205336,1206158,1206343,1206619,1206861,1207215,1208058,1208195,1208959,1209183,1209482,1209539,1209636,1210300,1210333,1210352,1210360,1210435,1210468,1210471,1210848,1210963,1211292,1211602,1211609,1211927,1211944,1212226,1212539,1212612,1212649,1212795,1213013,1213126,1213224,1213787,1213930,1213936,1214153,1214542,1214678,1214805,1215074,1215078,1215260,1215262,1215404,1215424,1215712,1215722,1215796,1215849,1215851,1216195,1216258,1216550,1216581,1217011,1217020,1217058,1217258,1217938,1217944,1218086,1218334,1218655,1218794,1218852,1218890,1219775,1219931,1219941,1220136,1220425,1220504,1220954,1221138,1221717,1222267,1222695,1222958,1223385,1223465,1225579,1225641,1225959,1226102,1226221,1226348,1226651,1226757,1226889,1227244,1227249,1227664,1229144,1230030,1230408,1230419,1230689,1231507,1231656,1232229,1232233,1232319,1232708,1232995,1233127,1233131,1233132,1233941,1234554,1234762,1235710,1236856,1237036,1237494,1237604,1238492,1239180,1239339,1239708,1239847,1239935,1239953,1241529,1241746,1241800,1241903,1242215,1242288,1242707,1242983,1243558,1243896,1245368,1246004,1246438,1247494,1249187,1250957,1252309,1254136,1254436,1254443,1254841,1255251,1255287,1255403,1256507,1257371,1257593,1258246,1258818,1259551,1259569,1260168,1260733,1261133,1261824,1262591,1262966,1263144,1263362,1263451,1263457,1264463,1264539,1265154,1265353,1265460,1265505];
var beta = [-0.016460,-0.017388,0.004666,-0.019444,-0.021467,-0.009792,-0.010983,-0.009672,-0.012383,-0.011944,-0.040783,
0.000040,-0.037706,-0.037048,-0.022093,0.008031,-0.026501,-0.011845,-0.039604,-0.038183,-0.004526,-0.039908
,0.026795,-0.044573,-0.091201,-0.043835,-0.020249,0.002993,-0.026893,-0.027035,-0.086729,-0.010482,0.020055
,-0.039701,0.002062,-0.001788,-0.028063,-0.022970,-0.038123,0.005381,-0.034169,-0.034990,-0.024945,-0.027820,
-0.044936,0.021576,-0.026793,-0.026565,-0.046091,-0.033547,-0.039460,-0.033031,-0.026737,-0.066936,-0.027110,
0.020461,-0.033472,-0.077878,-0.073586,-0.029645,-0.042413,-0.042787,-0.033266,-0.032679,-0.039023,-0.059078,
-0.032767,-0.038879,0.004720,-0.006656,0.019329,0.004563,-0.032864,-0.032930,0.004899,0.004848,0.018724,
-0.033351,0.004136,0.018651,0.011186,0.003325,0.018656,0.014529,0.022839,0.023000,-0.043287,-0.046515,
-0.031246,0.001790,0.011119,-0.060369,-0.069760,0.000059,-0.001467,0.003763,0.007810,-0.031736,-0.031873,
-0.031730,-0.041524,0.003154,0.003484,-0.031901,0.003962,-0.031931,0.010451,-0.038298,-0.035431,0.006745,
0.018657,-0.070051,0.020628,-0.032121,0.017980,0.004111,-0.012993,-0.019280,-0.017202,-0.018697,-0.003589,
-0.008329,0.005318,-0.010879,-0.049660,0.000257,-0.028038,-0.034095,0.043374,0.009247,-0.007339,0.002461,
0.021739,-0.009535,-0.009289,-0.014029,-0.015084,-0.016342,-0.013310,0.016131,-0.009589,-0.002353,0.010926,
0.047156,0.005105,0.031144,-0.001325,0.052328,-0.026188,-0.009385,-0.009095,0.011588,-0.002930,0.056441,
-0.000081,-0.021203,0.012995,0.017251,0.015505,0.014883,0.021222,-0.025785,-0.024879,0.047307,0.008877,
0.009344,0.024559,0.016231,0.017735,0.016492,-0.016796,0.000109,0.016239,-0.015273,0.015977,-0.014992,
-0.018192,-0.003449,-0.004032,-0.059479,-0.014315,-0.045340,-0.006197,-0.005628,-0.008134,0.003855,-0.046320,
-0.017330,-0.022492,-0.016921,-0.021448,-0.024674,0.004713,-0.048845,-0.061615,0.001277,0.016119,-0.056511,
-0.060329,0.016629,0.011746,-0.006146,-0.002325,-0.006215,-0.006039,0.016375,-0.007747,-0.005819,-0.003694,
-0.003273,-0.003485,-0.005966,-0.002373,-0.041619,-0.005140,-0.012773,-0.008922,0.015843,-0.012819,-0.013844,
-0.011856,-0.030025,-0.013082,-0.002228,-0.017867,-0.018346,-0.010766,-0.008622,0.018648,-0.012557,-0.067918]

var sizes = [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,15,15,15,15,15,15,15,15,15,15,15,
15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,
25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]
var abs_beta = beta.map(Math.abs)
var p_values_sig =  []
var p_values_nonsig = []
var locations_sig = []
var locations_nonsig = []
var upper_limit = Math.max.apply(null, log10_p_values) + 2

function size_beta(x) {
  if (x < 0.05){
    return 10;
  } else if (x < 0.10) {
    return 15;
  } else if (x < 0.20) {
    return 20;
  } else {
    return 25;
  } 
}


x = document.getElementById("betarange").value; 
function filter_betas(beta) {
  return beta > x;
};
function updateSlider() {
  x = document.getElementById("betarange").value; 
  abs_beta = abs_beta.filter(filter_betas);
  var write = document.getElementById("sliderAmount");
  write.innerHTML = abs_beta.length;
};

var size_plot = abs_beta.map(size_beta);


for (i in log10_p_values) {
	if (log10_p_values[i] > 1.30103){
		p_values_sig.push(log10_p_values[i]);
		locations_sig.push(locations[i]);
	}else{
		p_values_nonsig.push(log10_p_values[i]);
		locations_nonsig.push(locations[i]);
	}
}

//var value = document.getElementById("betarange").value;  







/*
function updateSlider(slideAmount) {
    return slideAmount;
}

var rangeInput = document.getElementById("betarange").value;

sliderAmount.innerHTML(rangeInput);

*/
var trace1 = {
  x: locations_sig,
  y: p_values_sig,
  mode: 'markers',
  type: 'scatter',
  name: 'significant',
  marker: {
    color: 'green',
    size: size_plot
    }
};

var trace2 = {
  x: locations_nonsig,
  y: p_values_nonsig,
  mode: 'markers',
  type: 'scatter',
  name: 'non significant',
  marker: {
    color: 'red',
    size: size_plot
    }
};

var data = [trace1,trace2];


var layout = {

  xaxis: {
    title: 'Chromosome 1 (Mb)',
    titlefont: {
      family: 'Arial, sans-serif',
      size: 18,

    },
    showline: true,
    showticklabels: true,
    zeroline: true,
    showgrid: false,
    tickfont: {
      family: 'Old Standard TT, serif',
      size: 14,
      color: 'black'
    },
    exponentformat: 'e',
    showexponent: 'All'
  },
  yaxis: {
    title: '-log10 (P value)',
    showline: true,
    showgrid: false,
    titlefont: {
      family: 'Arial, sans-serif',
      size: 18,
    },
    showticklabels: true,
    tickfont: {
      family: 'Old Standard TT, serif',
      size: 14,
      color: 'black'
    },
    exponentformat: 'e',
    showexponent: 'All',
    range: [0, upper_limit]
  },
  margin: {
    l: 50,
    r: 50,
    b: 100,
    t: 0,
    pad: 4
  },
  shapes: [
  {
      type: 'line',
      xref: 'paper',
      x0: 0,
      y0: 1.30103,
      x1: 1,
      y1: 1.30103,
      line:{
          color: 'grey',
          width: 1,
          dash:'dash'
        }
  }
]

};



Plotly.newPlot('myDiv', data, layout);







